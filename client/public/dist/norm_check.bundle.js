"use strict";(self.webpackChunknokiaplanningtool=self.webpackChunknokiaplanningtool||[]).push([[875],{77196:(e,t,n)=>{n.r(t),n.d(t,{default:()=>W});var r=n(35466),a=n(94235),l=n(72465),o=n(40647),c=n(15358),u=n(57676),i=n(15489),s=n(51275),m=n.n(s),d=n(49386),f=n(76779),h=n(21594),p=n(67369),y=n(88376),E=n(83119),b=n.n(E);function g(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,l=[],o=!0,c=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(l.push(r.value),!t||l.length!==t);o=!0);}catch(e){c=!0,a=e}finally{try{o||null==n.return||n.return()}finally{if(c)throw a}}return l}}(e,t)||v(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(e,t){if(e){if("string"==typeof e)return C(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?C(e,t):void 0}}function C(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function k(){return{width:"80%",maxWidth:"100vw",maxHeight:"100%",position:"fixed",top:"50%",left:"10%",transform:"translate(0, -50%)",overflowY:"auto"}}var w,S,R,N,x,A=(0,h.Z)((function(e){return(0,p.Z)({paper:{position:"absolute",width:1500,backgroundColor:e.palette.background.paper,border:"2px solid #000",boxShadow:e.shadows[5],padding:e.spacing(2,4,3)},button:{float:"right",backgroundcolor:"red"}})})),D=function(e){var t=g((0,r.useState)(24),2),n=t[0],a=(t[1],g((0,r.useState)(0),2)),l=a[0],o=a[1],c=g((0,r.useState)([]),2),u=c[0],s=c[1],h=A(),p=g(r.useState(k),1)[0],E=function(e){console.log({file:e})},w=r.createElement("div",{style:p,className:h.paper},r.createElement("button",{className:h.button,type:"button",onClick:e.handleModal},r.createElement(y.Z,null)),r.createElement(i.Z,{multipleFiles:!1,fileTypes:[".zip"],handleFiles:function(e){(new(m())).loadAsync(e[0]).then((function(e){var t=l;Object.keys(e.files).forEach((function(n,r){e.files[n].async("string").then((function(e){var r,a;(console.log(e),void 0===u.find((function(e){return e.fileName===n})))&&(u.push({fileName:n,content:e,status:"read-from-client"}),r=function(e){if(Array.isArray(e))return C(e)}(a=u)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(a)||v(a)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),t++,o(t),s(r))}))}))})).catch((function(e){console.log("there has been an error",e),console.log(e.message),setStatus(e.message)}))}},r.createElement(d.Z,{color:"primary",variant:"contained"},"Upload ZIP")),r.createElement("svg",{viewBox:"0 0 36 36",className:"circular-chart"},r.createElement("text",{x:"50%",y:"60%","text-anchor":"middle",className:"text"},0!==n?(l/n*100).toFixed(1)+"%":"waiting for files"),r.createElement("path",{class:"circle","stroke-dasharray":"".concat(l/n*100,", ",100),d:"M18 2.0945\r a 15.9155 15.9155 0 0 1 0 31.831\r a 15.9155 15.9155 0 0 1 0 -31.831"})),r.createElement("button",{className:h.button,type:"button",onClick:function(){console.log(u),u.forEach((function(e){return t=new FileReader,n=!!t.readAsBinaryString,void(t.onload=function(e){var t=e.target.result,r=b().read(t,{type:n?"binary":"array",bookVBA:!1,cellDates:!0}),a=r.SheetNames[0],l=r.Sheets[a],o=b().utils.sheet_to_json(l,{header:0,defval:"",raw:!1,dateNF:"YYYY-MM-DD"});console.log({data:o}),E(o)});var t,n}))}}));return r.createElement("div",null,r.createElement(f.Z,{style:{display:"flex",alignItems:"center",justifyContent:"center"},open:!0,"aria-labelledby":"simple-modal-title","aria-describedby":"simple-modal-description"},w))};function _(e){return function(e){if(Array.isArray(e))return I(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||T(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function O(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,l=[],o=!0,c=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(l.push(r.value),!t||l.length!==t);o=!0);}catch(e){c=!0,a=e}finally{try{o||null==n.return||n.return()}finally{if(c)throw a}}return l}}(e,t)||T(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function T(e,t){if(e){if("string"==typeof e)return I(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?I(e,t):void 0}}function I(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Q(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var q=(0,a.Ps)(w||(w=Q(["\n  query ($department: String!) { \n    normCheckQuery (department: $department) {\n        uid\n            Date \n            Resource \n            to_email\n            wbsCustomer \n            Task\n            taskComments\n            timeWrittingComments\n              billableHours\n              realHour\n              normOK\n              normNOK\n              status\n            variation\n            correction\n            Dep\n    }\n  }\n"]))),H=(0,a.Ps)(S||(S=Q(["\n  mutation ($data: [Norms], $data2: [capacityLawsonInput] $data3: [commentsCheckInput]) {\n    sendNotifications (data:$data, data2:$data2 data3:$data3){\n        success\n        message\n      }\n  }\n"]))),L=((0,a.Ps)(R||(R=Q(["\n  query {\n    normCheckQueryNA {\n            Date \n            Resource \n            wbsCustomer \n            Task\n            taskComments\n            timeWrittingComments\n              billableHours\n              realHour\n              normOK\n              normNOK\n              status\n            variation\n    }\n  }\n"]))),(0,a.Ps)(N||(N=Q(["\nquery($department: String!) {\n    commentsCheckQuery (department: $department)  {\n        uid\n        Dep\n        Date\n        Resource\n        to_email\n        Task\n        taskComments\n        timeWrittingComments\n        result\n        \n}}\n"])))),Z=(0,a.Ps)(x||(x=Q(["\n  query ($department: String!) {\n    capacityLawsonQuery  (department: $department) {\n        uid\n        Dep\n        Date\n        Resource\n        UPI\n        to_email\n        wbsCustomer\n        workFolderCode\n        wbsCheck\n        sumCapacity\n        sumLawson\n        variation\n        correction\n    }\n  }\n"])));const W=function(){var e=O((0,r.useState)(!1),2),t=(e[0],e[1],O((0,r.useState)(0),2)),n=(t[0],t[1],O((0,r.useState)(!1),2)),a=n[0],i=n[1],s=O((0,r.useState)(!1),2),m=s[0],d=s[1],f=O((0,r.useState)(!1),2),h=f[0],p=f[1],y=O((0,r.useState)(!0),2),E=y[0],b=y[1],g=O((0,r.useState)(!1),2),v=g[0],C=g[1],k=O((0,r.useState)(!1),2),w=k[0],S=k[1],R=O((0,r.useState)(!1),2),N=R[0],x=R[1],A=O((0,r.useState)([]),2),T=A[0],I=A[1],Q=O((0,r.useState)([]),2),W=Q[0],j=(Q[1],O((0,r.useState)([]),2)),$=j[0],F=j[1],K=O((0,r.useState)(""),2),P=(K[0],K[1]),M=O((0,r.useState)([]),2),z=M[0],V=M[1],B=O((0,r.useState)([]),2),Y=B[0],U=B[1],G=O((0,r.useState)([]),2),J=G[0],X=G[1],ee=O((0,r.useState)(!1),2),te=ee[0],ne=ee[1],re=O((0,r.useState)({style:{logoHeight:200}}),2),ae=re[0],le=re[1],oe=O((0,r.useState)([]),2),ce=oe[0],ue=oe[1],ie=O((0,r.useState)([]),2),se=ie[0],me=ie[1],de=O((0,r.useState)(0),2),fe=de[0],he=de[1],pe=(0,l.a)(q,{variables:{department:"radio"},onCompleted:function(){var e=[];ye&&ye.normCheckQuery&&ye.normCheckQuery.reduce((function(t,n){return t[n.Resource]||(t[n.Resource]={Resource:n.Resource,qty:0},e.push(t[n.Resource])),t[n.Resource].qty+=1,t}),{}),ue(e);var t=ye&&ye.normCheckQuery&&ye.normCheckQuery.map((function(e){return e.Dep}));me(_(new Set(t))),V(ye.normCheckQuery)}}),ye=pe.data,Ee=(pe.loading,pe.error,(0,l.a)(Z,{variables:{department:"radio"},onCompleted:function(){var e=[];be&&be.capacityLawsonQuery.reduce((function(t,n){return t[n.Resource]||(t[n.Resource]={Resource:n.Resource,qty:0},e.push(t[n.Resource])),t[n.Resource].qty+=1,t}),{});var t=[].concat(_(ce),e),n=[];t.reduce((function(e,t){return e[t.Resource]||(e[t.Resource]={Resource:t.Resource,qty:0},n.push(e[t.Resource])),e[t.Resource].qty+=t.qty,e}),{}),ue(n),U(be.capacityLawsonQuery)}})),be=Ee.data,ge=(Ee.loading,Ee.error,(0,l.a)(L,{variables:{department:"radio"},onCompleted:function(){var e=[];console.log(ve),ve&&ve.commentsCheckQuery.reduce((function(t,n){return t[n.Resource]||(t[n.Resource]={Resource:n.Resource,qty:0},e.push(t[n.Resource])),t[n.Resource].qty+=1,t}),{});var t=[].concat(_(ce),e),n=[];t.reduce((function(e,t){return e[t.Resource]||(e[t.Resource]={Resource:t.Resource,qty:0},n.push(e[t.Resource])),e[t.Resource].qty+=t.qty,e}),{}),ue(n),X(ve.commentsCheckQuery)}})),ve=ge.data,Ce=(ge.loadingCC,ge.errorCC,(0,o.D)(H,{onCompleted:function(e){P(e.sendNotifications.message),alert(e.sendNotifications.message)},onError:function(e){console.error("Error creating a post",e),alert("Error creating a post request "+e.message)}})),ke=O(Ce,1)[0],we=function(e,t){e.target.value?V(ye.normCheckQuery.filter((function(t){return t.Resource==e.target.value}))):V(ye.normCheckQuery),e.target.value?U(be.capacityLawsonQuery.filter((function(t){return t.Resource==e.target.value}))):U(be.capacityLawsonQuery),e.target.value?X(ve.commentsCheckQuery.filter((function(t){return t.Resource==e.target.value}))):X(ve.commentsCheckQuery)},Se=function(e,t){t.to_email?T.find((function(e){return e.uid==t.uid}))?(T.splice(T.findIndex((function(t){return t.uid===e})),1),he(W.length+T.length)):(T.push({type:"norms",uid:e,date:t.Date,resource:t.Resource,task:t.Task,taskComments:t.taskComments,bh:t.billableHours,rh:t.realHour,twc:t.timeWrittingComments,var:t.variation,to_email:t.to_email,normNok:t.normNOK,normOK:t.normOK,correction:t.correction}),he(W.length+T.length)):alert("please check database. entry has no email")};!function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:window,a=(0,r.useRef)();(0,r.useEffect)((function(){a.current=t}),[t]),(0,r.useEffect)((function(){if(n&&n.addEventListener){var t=function(e){return a.current(e)};return n.addEventListener(e,t),function(){n.removeEventListener(e,t)}}}),[e,n])}("scroll",(function(){var e=window.scrollY,t=Math.max(100,300-e);le({logoHeight:t,fontSize:100==t?"75%":"100%"})}));var Re=function(e,t){t.to_email?W.find((function(t){return t.uid==e}))?(W.splice(W.findIndex((function(t){return t.uid===e})),1),he(W.length+T.length)):(W.push({type:"lawson-capacity",uid:e,date:t.Date,resource:t.Resource,bh:t.billableHours,rh:t.realHour,wbsCustomer:t.wbsCustomer,workFolderCode:t.workFolderCode,sumCapacity:t.sumCapacity,sumLawson:t.sumLawson,wbsCheck:t.wbsCheck,var:t.variation,to_email:t.to_email,correction:t.correction}),he(W.length+T.length)):alert("please check database. entry has no email")},Ne=function(e,t){t.to_email?$.find((function(t){return t.uid==e}))?($.splice($.findIndex((function(t){return t.uid===e})),1),he($.length+T.length)):($.push({uid:e,date:t.Date,to_email:t.to_email,resource:t.Resource,comments:t.taskComments,twc:t.timeWrittingComments,task:t.Task,result:t.result}),he(W.length+T.length+ +$.length)):alert("please check database. entry has no email")},xe=function(e){"norms_capacity"===e&&(i(!a),z.forEach((function(e){Se(e.uid,e)}))),"lawson_capacity"===e&&(d(!m),Y.forEach((function(e){Re(e.uid,e)}))),"comments_check"===e&&(p(!h),J.forEach((function(e){Ne(e.uid,e)})))},Ae=function(){ne(!te)};return r.createElement("div",{className:"main"},r.createElement("div",{className:"tableHeader"},r.createElement("div",{className:"filterContainer"},r.createElement("form",{onSubmit:function(e){e.preventDefault()}},r.createElement(r.Fragment,null,te?r.createElement(D,{handleModal:Ae}):null,r.createElement(u.Z,{color:"primary",disabled:!1,onClick:Ae},"Upload files"),r.createElement(u.Z,{color:"danger",disabled:fe<1,onClick:function(){T.length>0||W.length>0||$.length>0?ke({variables:{data:T,data2:W,data3:$}}):alert("please select some tasks...")}},"Send ",fe," notification(s)")),r.createElement("select",{defaultValue:"",onChange:function(e){we(e)}},r.createElement("option",{value:""},"All resources"),ce&&ce.map((function(e,t){return r.createElement("option",{key:e+t,value:e.Resource},e.Resource," (",e.qty," tasks)")}))),r.createElement("select",{defaultValue:"",onChange:function(e){we(e)}},r.createElement("option",{value:""},"Department"),se&&se.map((function(e){return r.createElement("option",{key:e,value:e},e)}))),r.createElement(u.Z,{color:E?"primary":"secondary",onClick:function(){b(!E),C(!1),S(!1),x(!1)}},"Capacity vs Norms (",z&&z.length,") "),r.createElement(u.Z,{color:v?"primary":"secondary",onClick:function(){C(!v),b(!1),S(!1),x(!1)}},"Capacity vs Lawson (",Y&&Y.length,") "),r.createElement(u.Z,{color:w?"primary":"secondary",onClick:function(){S(!w),b(!1),C(!1),x(!1)}},"Capacity Comments Check (",J&&J.length,") "),r.createElement(u.Z,{disabled:!0,color:"secondary",onClick:function(){x(!N),b(!1),C(!1),S(!1)}},"Capacity vs NPT "))),r.createElement("div",{className:"reportingConatiner",style:{height:ae.logoHeight,fontSize:ae.fontSize}},r.createElement("div",{className:"left-container"},"RIGHT container"),r.createElement("div",{className:"right-container"},r.createElement("h5",{style:{fontSize:ae.fontSize}},"Selected items:"),r.createElement("ul",null,T&&T.map((function(e){return r.createElement("li",{key:e.uid},e.to_email,", ",e.date,", ",e.correction)})),W&&W.map((function(e){return r.createElement("li",{key:e.uid},e.to_email,", ",e.date,", ",e.correction)})),$&&$.map((function(e){return r.createElement("li",{key:e.uid},e.to_email,", ",e.date,", ",e.result)})))))),r.createElement("div",{className:"selectable-containers"},E?r.createElement("div",{className:"c1"},r.createElement(c.Z,{striped:!0,bordered:!0,hover:!0,responsive:"xl",className:"norms-check-table"},r.createElement("thead",null,r.createElement("tr",null,r.createElement("th",null,"Select ",r.createElement("input",{type:"checkbox",checked:a,onChange:function(e){return xe("norms_capacity")}})),r.createElement("th",null,"Date"),r.createElement("th",null,"Engineer"),r.createElement("th",null,"WBS"),r.createElement("th",null,"Capacity"),r.createElement("th",null,"Comments"),r.createElement("th",null,"TWC"),r.createElement("th",null,"BH"),r.createElement("th",null,"RH"),r.createElement("th",null,"NORM OK"),r.createElement("th",null,"NORM NOK"),r.createElement("th",null,"Status"),r.createElement("th",null,"Variation"),r.createElement("th",null,"Possible Correction"))),r.createElement("tbody",null,z&&z.map((function(e,t){return r.createElement("tr",{key:e.uid},r.createElement("td",null," ",r.createElement("input",{type:"checkbox",checked:!!T.find((function(t){return t.uid==e.uid})),onChange:function(t){return Se(e.uid,e)}})),r.createElement("td",null,e.Date),r.createElement("td",null,e.Resource),r.createElement("td",null,e.wbsCustomer),r.createElement("td",null,e.Task),r.createElement("td",null,r.createElement("span",{title:e.taskComments},e.taskComments.substring(0,10))," "),r.createElement("td",null,r.createElement("span",{title:e.timeWrittingComments},e.timeWrittingComments.substring(0,10)),"  "),r.createElement("td",null,e.billableHours),r.createElement("td",null,e.realHour),r.createElement("td",null,e.normOK),r.createElement("td",null,e.normNOK),r.createElement("td",null,e.status),r.createElement("td",null,e.variation),r.createElement("td",{className:"cellTextArea"},r.createElement("textarea",{rows:2,defaultValue:e.correction||"please check",disabled:!T.find((function(t){return t.uid==e.uid})),onChange:function(t){return n=e.uid,r=t.target.value,(a=_(T)).find((function(e){return e.uid==n})).correction=r,void I(a);var n,r,a}})))}))))):null,v?r.createElement("div",{className:"c2"},r.createElement(c.Z,{striped:!0,bordered:!0,hover:!0,className:"normsTable"},r.createElement("thead",null,r.createElement("tr",null,r.createElement("th",null,"Select ",r.createElement("p",null,r.createElement("input",{type:"checkbox",checked:m,onChange:function(e){return xe("lawson_capacity")}}))),r.createElement("th",null,"Date"),r.createElement("th",null,"Engineer"),r.createElement("th",null,"WBS Capacity"),r.createElement("th",null,"WFC Lawson"),r.createElement("th",null,"WBS Check"),r.createElement("th",null,"sumCapacity"),r.createElement("th",null,"sumLawson"),r.createElement("th",null,"Variation"),r.createElement("th",null,"Possible Correction"))),r.createElement("tbody",null,Y&&Y.map((function(e,t){return r.createElement("tr",{key:e.uid},r.createElement("td",null," ",r.createElement("input",{type:"checkbox",checked:!!W.find((function(t){return t.uid==e.uid})),onChange:function(t){return Re(e.uid,e)}})),r.createElement("td",null,e.Date),r.createElement("td",null,e.Resource),r.createElement("td",null,e.wbsCustomer),r.createElement("td",null,e.workFolderCode),r.createElement("td",null,e.wbsCheck),r.createElement("td",null,e.sumCapacity),r.createElement("td",null,e.sumLawson),r.createElement("td",null,e.variation),r.createElement("td",null,r.createElement("textarea",{defaultValue:e.correction,disabled:!W.find((function(t){return t.uid==e.uid})),onChange:function(t){return n=e.uid,r=t.target.value,a=_(W),W.find((function(e){return e.uid==n})).correction=r,void I(a);var n,r,a}})))}))))):null,w?r.createElement("div",{className:"c3"},r.createElement(c.Z,{striped:!0,bordered:!0,hover:!0,className:"normsTable"},r.createElement("thead",null,r.createElement("tr",null,r.createElement("th",null,"Select ",r.createElement("p",null,r.createElement("input",{type:"checkbox",checked:h,onChange:function(e){return xe("comments_check")}}))),r.createElement("th",null,"Date"),r.createElement("th",null,"Engineer"),r.createElement("th",null,"Task"),r.createElement("th",null,"Comments"),r.createElement("th",null,"Time Writting Comments"),r.createElement("th",null,"Result"))),r.createElement("tbody",null,J&&J.map((function(e,t){return r.createElement("tr",{key:e.uid},r.createElement("td",null," ",r.createElement("input",{type:"checkbox",checked:!!$.find((function(t){return t.uid==e.uid})),onChange:function(t){return Ne(e.uid,e)}})),r.createElement("td",null,e.Date),r.createElement("td",null,e.Resource),r.createElement("td",null,e.Task),r.createElement("td",null,e.taskComments),r.createElement("td",null,e.timeWrittingComments),r.createElement("td",null,r.createElement("textarea",{rows:2,disabled:!$.find((function(t){return t.uid==e.uid})),defaultValue:e.result||"please check comments",onChange:function(t){return n=e.uid,r=t.target.value,(a=_($)).find((function(e){return e.uid==n})).result=r,void F(a);var n,r,a}})))}))))):null,N?r.createElement("div",{className:"c4"},"C4"):null))}}}]);